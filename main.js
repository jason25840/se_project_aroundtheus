!function(){"use strict";var e=class{constructor(e,t,s,r,n){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._handleDeleteClick=r,this._handleLikeClick=n,this._cardSelector=t,this._openPreviewModal=s}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}handleLikeButton(){this._cardLikeButton.classList.toggle("card__like-button_active")}_toggleLike(){this._isLiked?this._cardLikeButton.classList.add("card__like-button_active"):this._cardLikeButton.classList.remove("card__like-button_active")}handleTrashButton(){this._cardElement.remove(),this._cardElement=null}_setEventListeners(){this._cardLikeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardElement.querySelector(".card__trash-button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._openPreviewModal({name:this._name,link:this._link})}))}getCardElement(){return this._cardElement=this._getTemplate(),this._cardLikeButton=this._cardElement.querySelector(".card__like-button"),this._cardElement.querySelector(".card__image").src=this._link,this._cardElement.querySelector(".card__title").textContent=this._name,this._cardElement.querySelector(".card__image").alt=this.name,this._toggleLike(),this._setEventListeners(),this._cardElement}},t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass,this._inputErrorClass)}_toggleButtonState(){if(this._hasInvalidInput(this._inputElement))return this._submitButton.classList.add(this._inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_hasInvalidInput(e){return![...e].every((e=>e.validity.valid))}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_setEventListeners(){this._inputElement=this._formElement.querySelectorAll(this._inputSelector),this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElement.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._formElement.reset(),this._toggleButtonState()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class s{constructor(e){this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleMouseClickModalClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleMouseClickModalClose)}_handleEscClose=e=>{if("Escape"===e.key){const e=document.querySelector(".modal_opened");this.close(e)}};_handleMouseClickModalClose(e){if(e.target.classList.contains("modal")){const e=document.querySelector(".modal_opened");this.close(e)}}setEventListeners(){this._popupElement.querySelector(".modal__close").addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}class r extends s{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._submitBtn=this._popupElement.querySelector(".modal__button"),this._submitBtnText=this._submitBtn.textContent}_getInputValues(){const e=this._popupForm.querySelectorAll(".modal__input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}class n{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._element=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._element.prepend(e)}}const i=document.querySelector("#profile-edit-button"),o=(document.querySelector("#profile-edit-modal").querySelector(".modal__close"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input")),l=document.querySelector("#profile-description-input"),a=(document.querySelector(".profile__avatar-button"),document.querySelector("#edit-avatar-modal").querySelector(".modal__close"),document.querySelector("#avatar-link-input"),document.querySelector(".profile__avatar")),d=(document.querySelector("#add-card-modal").querySelector(".modal__close"),document.querySelector("#image__add-button")),c=document.forms["profile-form"],u=document.forms["card-form"],h=document.querySelector("#modal__delete-form"),_=(document.querySelector("#profile-title-input"),document.querySelector("#profile-description-input"),document.querySelector("#avatar-form")),m=(document.querySelector(".cards__gallery"),document.querySelector("#card-template").content.firstElementChild,document.querySelector("#image-title-input"),document.querySelector("#image-url-input"),h.querySelector(".modal-delete-button"),document.querySelector("#modal__preview-card")),p=(document.querySelector(".modal__preview-image"),m.querySelector("#preview-title"),m.querySelector(".modal__close"),{formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"}),v="#card-template";function E(e){C.open(e)}const f=new class{constructor(e){let{baseUrl:t,headers:s}=e;this.server=t,this.headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this.server}/users/me`,{headers:this.headers}).then(this._checkResponse)}getInitialCards(){return fetch(`${this.server}/cards`,{headers:this.headers}).then(this._checkResponse)}renderCards(){Promise.all(this.getUserInfo(),this.getInitialCards())}userProfileInfo(e,t){return fetch(`${this.server}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}updateAvatar(e){return fetch(`${this.server}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}addNewCard(e,t){return fetch(`${this.server}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this.server}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this.server}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then(this._checkResponse).then((()=>console.log("Card has been liked")))}dislikeCard(e){return fetch(`${this.server}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then(this._checkResponse).then((()=>console.log("Card is not yet liked")))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"d5d1d874-a161-48bd-b3b4-ae8e38400ed9","Content-Type":"application/json"}});let S;function y(t){const s=new e(t,v,E,T,x).getCardElement();S.addItem(s)}f.getUserInfo().then((e=>{k.setUserInfo(e),k.setUserAvatar(e)})).catch((e=>{console.log(e)})),f.getInitialCards().then((e=>{S=new n({items:e,renderer:y},".cards__gallery"),S.renderItems()})).catch((e=>{console.log(e)}));const k=new class{constructor(e,t,s){this._nameElement=document.querySelector(e),this._descriptionElement=document.querySelector(t),this._userAvatar=s}getUserInfo(){return{name:this._nameElement.textContent,description:this._descriptionElement.textContent,avatar:this._userAvatar.src}}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._descriptionElement.textContent=s}setUserAvatar(e){this._userAvatar.src=e.avatar}}(".profile__title",".profile__description",a),L=new r("#profile-edit-modal",(function(e){L.renderLoading(!0),f.userProfileInfo(e.name,e.description).then((e=>{console.log(e),k.setUserInfo(e),L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.renderLoading(!1)}))})),g=new r("#add-card-modal",(function(e){g.renderLoading(!0),f.addNewCard(e.name,e.link).then((e=>{y(e),g.close(),w.resetValidation()})).catch((e=>{console.log(e)})).finally((()=>{g.renderLoading(!1)}))})),C=new class extends s{constructor(e){super(e),this._imageElement=document.querySelector(".modal__preview-image"),this._imageTitle=document.querySelector("#preview-title")}open(e){let{name:t,link:s}=e;this._imageElement.src=s,this._imageElement.alt=t,this._imageTitle.textContent=t,super.open()}}("#modal__preview-card"),b=new class extends s{constructor(e){super(e),this._popUpForm=this._popupElement.querySelector(".modal__form")}handleDelete(e){this._handleDeleteSubmit=e}setEventListeners(){super.setEventListeners(),this._popUpForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}}("#delete-card-modal"),q=new r("#edit-avatar-modal",(function(e){q.renderLoading(!0),f.updateAvatar(e.link).then((e=>{k.setUserAvatar(e)})).then((()=>{console.log("Avatar has been updated"),q.close()})).catch((e=>{console.error(e)})).finally((()=>{q.renderLoading(!1)}))})),B=new t(p,c),w=new t(p,u),I=new t(p,h),U=new t(p,_);function x(e){console.log(e),e.isLiked&&f.dislikeCard(e._id).then((()=>{e.handleLikeButton(),e.isLiked=!1})).catch((e=>{console.error(e)})),e.isLiked||f.likeCard(e._id).then((()=>{e.handleLikeButton(),e.isLiked=!0})).catch((e=>{console.error(e)}))}function T(e){console.log(e),b.open(),b.handleDelete((()=>{f.deleteCard(e._id).then((()=>{b.close(),e.handleTrashButton()})).catch((e=>{console.log(e)}))}))}i.addEventListener("click",(()=>{L.open();const e=k.getUserInfo();o.value=e.name,l.value=e.description})),d.addEventListener("click",(()=>{g.open()})),a.addEventListener("click",(()=>{q.open()})),L.setEventListeners(),g.setEventListeners(),C.setEventListeners(),b.setEventListeners(),q.setEventListeners(),B.enableValidation(),w.enableValidation(),I.enableValidation(),U.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVdTLEVBQUsvSixLQUNoQnlJLE1BQUssS0FDSjJDLEVBQW1COUcsUUFDbkJ5RixFQUFLM0ksbUJBQW1CLElBRXpCaUosT0FBT0MsSUFDTmIsUUFBUUMsSUFBSVksRUFBSSxHQUNoQixHQUVSLENBd0JBMUQsRUFBa0JyRixpQkFBaUIsU0FBUyxLQUMxQ3VKLEVBQWdCM0csT0FDaEIsTUFBTStILEVBQVdoQyxFQUFTM0IsY0FDMUIxQixFQUFrQnJCLE1BQVEwRyxFQUFTck0sS0FDbkNpSCxFQUF3QnRCLE1BQVEwRyxFQUFTckIsV0FBVyxJQUd0RDdELEVBQWlCekYsaUJBQWlCLFNBQVMsS0FDekN5SixFQUFhN0csTUFBTSxJQUdyQjRDLEVBQVl4RixpQkFBaUIsU0FBUyxLQUNwQ3FLLEVBQWlCekgsTUFBTSxJQUd6QjJHLEVBQWdCbEcsb0JBQ2hCb0csRUFBYXBHLG9CQUNiK0MsRUFBa0IvQyxvQkFDbEJ3RyxFQUFtQnhHLG9CQUNuQmdILEVBQWlCaEgsb0JBSWpCa0gsRUFBa0JoSSxtQkFDbEJtSCxFQUFpQm5ILG1CQUNqQmtJLEVBQW9CbEksbUJBQ3BCbUksRUFBZ0JuSSxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgY2FyZERhdGEsXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIG9wZW5QcmV2aWV3TW9kYWwsXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xuICAgIHRoaXMuX2lkID0gY2FyZERhdGEuX2lkO1xuICAgIHRoaXMuX2lzTGlrZWQgPSBjYXJkRGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9vcGVuUHJldmlld01vZGFsID0gb3BlblByZXZpZXdNb2RhbDtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBoYW5kbGVMaWtlQnV0dG9uKCkge1xuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH1cblxuICBfdG9nZ2xlTGlrZSgpIHtcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xuICAgICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVUcmFzaEJ1dHRvbigpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaC1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcbiAgICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fb3BlblByZXZpZXdNb2RhbCh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGdldENhcmRFbGVtZW50KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbiA9XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIikuYWx0ID0gdGhpcy5uYW1lO1xuICAgIHRoaXMuX3RvZ2dsZUxpa2UoKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhcmQ7XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG5cbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcblxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcblxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcbiAgICAgIHRoaXMuX2Vycm9yQ2xhc3MsXG4gICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3NcbiAgICApO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbGVtZW50KSkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcbiAgICByZXR1cm4gIVsuLi5pbnB1dExpc3RdLmV2ZXJ5KChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFxuICAgICAgdGhpcy5faW5wdXRTZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnQuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlTW91c2VDbGlja01vZGFsQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlTW91c2VDbGlja01vZGFsQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgICB0aGlzLmNsb3NlKG1vZGFsKTtcbiAgICB9XG4gIH07XG5cbiAgX2hhbmRsZU1vdXNlQ2xpY2tNb2RhbENsb3NlKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcbiAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgICB0aGlzLmNsb3NlKG1vZGFsKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbiAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnRuVGV4dCA9IHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgY29uc3QgaW5wdXRJdGVtcyA9IHt9O1xuXG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dEl0ZW1zW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGlucHV0SXRlbXM7XG4gIH1cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdG5UZXh0O1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2VsZW1lbnQucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufSIsIi8qRWxlbWVudHMqL1xuXG4vKnByb2ZpbGUgZWxlbWVudHMqL1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVDbG9zZUJ1dHRvbiA9XG4gIHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuXG4vKmF2YXRhciBlbGVtZW50cyovXG5cbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhckVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1hdmF0YXItbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYXZhdGFyQ2xvc2VCdXR0b24gPVxuICBhdmF0YXJFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5leHBvcnQgY29uc3QgYXZhdGFyTGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbGluay1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuXG4vKmFkZENhcmQgZWxlbWVudHMqL1xuXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWxDbG9zZUJ1dHRvbiA9XG4gIGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZV9fYWRkLWJ1dHRvblwiKTtcblxuLypmb3JtIGVsZW1lbnRzKi9cblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XG5leHBvcnQgY29uc3QgY2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImNhcmQtZm9ybVwiXTtcbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX2RlbGV0ZS1mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IG5ld05hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XG5leHBvcnQgY29uc3QgbmV3Sm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCIpO1xuZXhwb3J0IGNvbnN0IGZvcm1EYXRhID0geyB0aXRsZTogbmV3TmFtZSwgZGVzY3JpcHRpb246IG5ld0pvYiB9O1xuZXhwb3J0IGNvbnN0IGF2YXRhclVwZGF0ZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1mb3JtXCIpO1xuXG5cbi8qY2FyZCBlbGVtZW50cyovXG5cbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fZ2FsbGVyeVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcbmV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2UtdGl0bGUtaW5wdXRcIik7XG5leHBvcnQgY29uc3QgY2FyZFVybElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS11cmwtaW5wdXRcIik7XG5leHBvcnQgY29uc3QgY2FyZERlbGV0ZUJ1dHRvbiA9IGRlbGV0ZUNhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwtZGVsZXRlLWJ1dHRvblwiKTtcblxuLypwcmV2aWV3IGVsZW1lbnRzKi9cblxuZXhwb3J0IGNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX3ByZXZpZXctY2FyZFwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3TW9kYWxJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCJcbik7XG5leHBvcnQgY29uc3QgcHJldmlld1RpdGxlID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy10aXRsZVwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3Q2xvc2VCdXR0b24gPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgY2FyZFNlY3Rpb246IFwiLmNhcmRzX19nYWxsZXJ5XCIsXG4gIGNhcmRUZW1wbGF0ZTogXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICBwb3B1cEZvcm06IFwibW9kYWxfX2Zvcm1cIixcbiAgcHJldmlld01vZGFsOiBcIiNtb2RhbF9fcHJldmlldy1jYXJkXCIsXG4gIHByZXZpZXdJbWFnZTogXCJtb2RhbF9fcHJldmlldy1pbWFnZVwiLFxuICBhZGRDYXJkTW9kYWw6IFwiI2FkZC1jYXJkLW1vZGFsXCIsXG59O1xuIiwiLy9JbXBvcnRzXG5cbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCB7XG4gIHNlbGVjdG9ycyxcbiAgY29uZmlnLFxuICBwcm9maWxlRm9ybSxcbiAgY2FyZEZvcm0sXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBhZGROZXdDYXJkQnV0dG9uLFxuICBwcm9maWxlVGl0bGVJbnB1dCxcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXG4gIGRlbGV0ZUNhcmRGb3JtLFxuICBhdmF0YXJVcGRhdGVGb3JtLFxuICBhdmF0YXJJbWFnZSBcbn0gZnJvbSBcIi4uLy4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG4vKkZ1bmN0aW9ucyovXG5cbmZ1bmN0aW9uIG9wZW5QcmV2aWV3TW9kYWwoZGF0YSkge1xuICBwcmV2aWV3SW1hZ2VQb3B1cC5vcGVuKGRhdGEpO1xufVxuXG4vKiBJbnN0YW50aWF0aW9ucyovXG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImQ1ZDFkODc0LWExNjEtNDhiZC1iM2I0LWFlOGUzODQwMGVkOVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmxldCBjYXJkU2VjdGlvbjtcblxuYXBpXG4gIC5nZXRVc2VySW5mbygpXG4gIC50aGVuKChyZXMpID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xuICB9KTtcblxuYXBpXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAudGhlbigocmVzKSA9PiB7XG4gICAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHsgaXRlbXM6IHJlcywgcmVuZGVyZXI6IHJlbmRlckNhcmQgfSxcbiAgICAgIFwiLmNhcmRzX19nYWxsZXJ5XCJcbiAgICApO1xuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBzZWxlY3RvcnMuY2FyZFRlbXBsYXRlLFxuICAgIG9wZW5QcmV2aWV3TW9kYWwsXG4gICAgaGFuZGxlQ2FyZERlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApLmdldENhcmRFbGVtZW50KCk7XG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZCk7XG59XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFwiLnByb2ZpbGVfX3RpdGxlXCIsIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsIGF2YXRhckltYWdlKTtcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXRcbik7XG5jb25zdCBjYXJkRWRpdEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhZGQtY2FyZC1tb2RhbFwiLCBoYW5kbGVDYXJkRm9ybVN1Ym1pdCk7XG5jb25zdCBwcmV2aWV3SW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNtb2RhbF9fcHJldmlldy1jYXJkXCIpO1xuY29uc3QgY29uZmlybURlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm0oXCIjZGVsZXRlLWNhcmQtbW9kYWxcIik7XG5cbmNvbnN0IGF2YXRhckltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjZWRpdC1hdmF0YXItbW9kYWxcIixcbiAgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdFxuKTtcblxuLypWYWxpZGF0aW9uKi9cblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVGb3JtKTtcbmNvbnN0IGFkZENhcmRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGNhcmRGb3JtKTtcbmNvbnN0IGRlbGV0ZUNhcmRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGRlbGV0ZUNhcmRGb3JtKTtcbmNvbnN0IGF2YXRhclZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgYXZhdGFyVXBkYXRlRm9ybSk7XG5cbi8qRXZlbnQgSGFuZGxlcnMqL1xuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChpbnB1dEl0ZW1zKSB7XG4gIHByb2ZpbGVFZGl0Rm9ybS5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAudXNlclByb2ZpbGVJbmZvKGlucHV0SXRlbXMubmFtZSwgaW5wdXRJdGVtcy5kZXNjcmlwdGlvbilcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzKTtcbiAgICAgIHByb2ZpbGVFZGl0Rm9ybS5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwcm9maWxlRWRpdEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBoYW5kbGVDYXJkRm9ybVN1Ym1pdChkYXRhKSB7XG4gIGNhcmRFZGl0Rm9ybS5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuYWRkTmV3Q2FyZChkYXRhLm5hbWUsIGRhdGEubGluaylcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKHJlcyk7XG4gICAgICBjYXJkRWRpdEZvcm0uY2xvc2UoKTtcbiAgICAgIGFkZENhcmRWYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGNhcmRFZGl0Rm9ybS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcbiAgY29uc29sZS5sb2coY2FyZCk7XG4gIGlmIChjYXJkLmlzTGlrZWQpIHtcbiAgICBhcGlcbiAgICAgIC5kaXNsaWtlQ2FyZChjYXJkLl9pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5oYW5kbGVMaWtlQnV0dG9uKCk7XG4gICAgICAgIGNhcmQuaXNMaWtlZCA9IGZhbHNlO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG4gIGlmICghY2FyZC5pc0xpa2VkKSB7XG4gICAgYXBpXG4gICAgICAubGlrZUNhcmQoY2FyZC5faWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuaGFuZGxlTGlrZUJ1dHRvbigpO1xuICAgICAgICBjYXJkLmlzTGlrZWQgPSB0cnVlO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUNhcmREZWxldGVDbGljayhjYXJkKSB7XG4gIGNvbnNvbGUubG9nKGNhcmQpO1xuICBjb25maXJtRGVsZXRlUG9wdXAub3BlbigpO1xuICBjb25maXJtRGVsZXRlUG9wdXAuaGFuZGxlRGVsZXRlKCgpID0+IHtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuX2lkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjb25maXJtRGVsZXRlUG9wdXAuY2xvc2UoKTtcbiAgICAgICAgY2FyZC5oYW5kbGVUcmFzaEJ1dHRvbigpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoZGF0YSkge1xuICBhdmF0YXJJbWFnZVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG5cbiAgYXBpXG4gICAgLnVwZGF0ZUF2YXRhcihkYXRhLmxpbmspXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMpO1xuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJBdmF0YXIgaGFzIGJlZW4gdXBkYXRlZFwiKTtcbiAgICAgIGF2YXRhckltYWdlUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBhdmF0YXJJbWFnZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG4vKkV2ZW50IExpc3RlbmVycyovXG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHByb2ZpbGVFZGl0Rm9ybS5vcGVuKCk7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5uYW1lO1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXJEYXRhLmRlc2NyaXB0aW9uO1xufSk7XG5cbmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2FyZEVkaXRGb3JtLm9wZW4oKTtcbn0pO1xuXG5hdmF0YXJJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhdmF0YXJJbWFnZVBvcHVwLm9wZW4oKTtcbn0pO1xuXG5wcm9maWxlRWRpdEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmNhcmRFZGl0Rm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xucHJldmlld0ltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmNvbmZpcm1EZWxldGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuYXZhdGFySW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vL0luaXRpYWxpemF0aW9uXG5cbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZENhcmRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuZGVsZXRlQ2FyZFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hdmF0YXJWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuc2VydmVyID0gYmFzZVVybDtcbiAgICB0aGlzLmhlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuc2VydmVyfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLnNlcnZlcn0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuICByZW5kZXJDYXJkcygpIHtcbiAgICBQcm9taXNlLmFsbCh0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCkpO1xuICB9XG5cbiAgdXNlclByb2ZpbGVJbmZvKG5hbWUsIGFib3V0KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuc2VydmVyfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlQXZhdGFyKGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5zZXJ2ZXJ9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgYWRkTmV3Q2FyZChuYW1lLCBsaW5rKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuc2VydmVyfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGxpbms6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5zZXJ2ZXJ9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuc2VydmVyfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gICAgICAudGhlbigoKSA9PiBjb25zb2xlLmxvZyhcIkNhcmQgaGFzIGJlZW4gbGlrZWRcIikpO1xuICB9XG5cbiAgZGlzbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuc2VydmVyfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gICAgICAudGhlbigoKSA9PiBjb25zb2xlLmxvZyhcIkNhcmQgaXMgbm90IHlldCBsaWtlZFwiKSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBkZXNjcmlwdGlvblNlbGVjdG9yLCB1c2VyQXZhdGFyKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvblNlbGVjdG9yKTtcbiAgICB0aGlzLl91c2VyQXZhdGFyID0gdXNlckF2YXRhclxuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGF2YXRhciA6dGhpcy5fdXNlckF2YXRhci5zcmNcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGFib3V0O1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcbiAgICB0aGlzLl91c2VyQXZhdGFyLnNyYyA9IGF2YXRhci5hdmF0YXJcbiAgfVxufVxuXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCIpO1xuICAgIHRoaXMuX2ltYWdlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctdGl0bGVcIik7XG4gIH1cblxuICBvcGVuKHsgbmFtZSwgbGluayB9KSB7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGxpbms7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IG5hbWU7XG4gICAgdGhpcy5faW1hZ2VUaXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XG5cbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3BVcCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3BVcFdpdGhDb25maXJtIGV4dGVuZHMgUG9wVXAge1xuICBjb25zdHJ1Y3Rvcihwb3BVcFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wVXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wVXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gIH1cblxuICBoYW5kbGVEZWxldGUoaGFuZGxlRGVsZXRlU3VibWl0KSB7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0ID0gaGFuZGxlRGVsZXRlU3VibWl0O1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3BVcEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZVN1Ym1pdCgpO1xuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJjYXJkRGF0YSIsImNhcmRTZWxlY3RvciIsIm9wZW5QcmV2aWV3TW9kYWwiLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2NhcmRTZWxlY3RvciIsIl9vcGVuUHJldmlld01vZGFsIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiaGFuZGxlTGlrZUJ1dHRvbiIsIl9jYXJkTGlrZUJ1dHRvbiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl90b2dnbGVMaWtlIiwiYWRkIiwicmVtb3ZlIiwiaGFuZGxlVHJhc2hCdXR0b24iLCJfY2FyZEVsZW1lbnQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2V0Q2FyZEVsZW1lbnQiLCJzcmMiLCJ0ZXh0Q29udGVudCIsImFsdCIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRFbGVtZW50IiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiaW5wdXRMaXN0IiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZSIsInJlc2V0VmFsaWRhdGlvbiIsInJlc2V0IiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlTW91c2VDbGlja01vZGFsQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJtb2RhbCIsInRhcmdldCIsImNvbnRhaW5zIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3N1Ym1pdEJ0biIsIl9zdWJtaXRCdG5UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRzIiwiaW5wdXRJdGVtcyIsImlucHV0IiwidmFsdWUiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJTZWN0aW9uIiwiX3JlZiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9lbGVtZW50IiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiYXZhdGFySW1hZ2UiLCJhZGROZXdDYXJkQnV0dG9uIiwicHJvZmlsZUZvcm0iLCJmb3JtcyIsImNhcmRGb3JtIiwiZGVsZXRlQ2FyZEZvcm0iLCJhdmF0YXJVcGRhdGVGb3JtIiwicHJldmlld01vZGFsIiwiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwic2VsZWN0b3JzIiwiZGF0YSIsInByZXZpZXdJbWFnZVBvcHVwIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJzZXJ2ZXIiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsImdldEluaXRpYWxDYXJkcyIsInJlbmRlckNhcmRzIiwiYWxsIiwidXNlclByb2ZpbGVJbmZvIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZUF2YXRhciIsImF2YXRhciIsImFkZE5ld0NhcmQiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwibGlrZUNhcmQiLCJjb25zb2xlIiwibG9nIiwiZGlzbGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwiY2FyZFNlY3Rpb24iLCJyZW5kZXJDYXJkIiwiY2FyZCIsIkNhcmQiLCJoYW5kbGVDYXJkRGVsZXRlQ2xpY2siLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsImNhdGNoIiwiZXJyIiwibmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsInVzZXJBdmF0YXIiLCJfbmFtZUVsZW1lbnQiLCJfZGVzY3JpcHRpb25FbGVtZW50IiwiX3VzZXJBdmF0YXIiLCJkZXNjcmlwdGlvbiIsInByb2ZpbGVFZGl0Rm9ybSIsImZpbmFsbHkiLCJjYXJkRWRpdEZvcm0iLCJhZGRDYXJkVmFsaWRhdG9yIiwiX2ltYWdlRWxlbWVudCIsIl9pbWFnZVRpdGxlIiwiY29uZmlybURlbGV0ZVBvcHVwIiwiUG9wVXAiLCJwb3BVcFNlbGVjdG9yIiwiX3BvcFVwRm9ybSIsImhhbmRsZURlbGV0ZSIsImhhbmRsZURlbGV0ZVN1Ym1pdCIsIl9oYW5kbGVEZWxldGVTdWJtaXQiLCJldnQiLCJhdmF0YXJJbWFnZVBvcHVwIiwiZXJyb3IiLCJlZGl0Rm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJkZWxldGVDYXJkVmFsaWRhdG9yIiwiYXZhdGFyVmFsaWRhdG9yIiwidXNlckRhdGEiXSwic291cmNlUm9vdCI6IiJ9